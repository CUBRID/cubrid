image:
  - Visual Studio 2017

environment:
  CMAKE_GENERATOR: "Visual Studio 15 2017 Win64"
  BUILD_TYPE: RelWithDebInfo

matrix:
  fast_finish: true

install:
  - cinst ant -i

clone_script:
- cmd: >-
    git clone -q --branch=%APPVEYOR_REPO_BRANCH% https://github.com/%APPVEYOR_REPO_NAME%.git %APPVEYOR_BUILD_FOLDER%
    && cd %APPVEYOR_BUILD_FOLDER%
    && git checkout -qf %APPVEYOR_REPO_COMMIT%
    && git submodule sync
    && git submodule update --init
    && git rm -f cubridmanager

build_script:
  - cmake -E make_directory build
  - cmake -E chdir build cmake -G "%CMAKE_GENERATOR%" -DCMAKE_BUILD_TYPE=%BUILD_TYPE% ..
  - cmake --build build --config %BUILD_TYPE%
